from datetime import datetime


text = """user_4 26/12 20:00 [success]
user_3 28/08 12:12 [success]
user_7 15/10 18:24 [success]
user_3 11/02 08:59 [success]
user_3 24/10 05:15 [success]
user_5 09/05 05:45 [success]
user_4 04/11 14:24 [success]
user_3 28/12 20:06 [success]
user_8 11/08 06:18 [success]
user_4 05/09 09:31 [success]
user_3 23/01 13:42 [success]
user_4 13/11 14:29 [success]
user_6 01/04 22:32 [success]
user_5 10/02 12:24 [success]
user_4 14/08 08:02 [success]
user_7 25/02 03:07 [failure]
user_2 03/05 07:17 [failure]
user_5 09/01 05:36 [success]
user_6 04/10 14:43 [success]
user_4 03/09 09:55 [success]
user_4 26/10 05:21 [success]
user_3 09/02 08:24 [success]
user_6 21/05 10:00 [success]
user_8 07/07 10:57 [success]
user_6 26/08 16:32 [success]
user_3 12/11 21:51 [success]
user_2 11/10 08:14 [success]
user_6 27/06 10:01 [success]
user_8 10/11 07:58 [failure]
user_2 19/04 02:55 [success]
user_5 22/07 06:02 [success]
user_5 26/09 10:24 [success]
user_1 15/11 03:44 [success]
user_6 02/09 01:14 [success]
user_1 28/10 12:37 [success]
user_5 08/06 10:22 [success]
user_6 12/12 07:07 [success]
user_5 17/07 10:15 [success]
user_7 10/11 21:11 [failure]
user_6 05/12 18:34 [success]
user_1 10/08 18:27 [failure]
user_3 22/02 23:33 [success]
user_4 03/11 06:57 [success]
user_7 06/05 18:06 [failure]
user_2 17/01 14:12 [success]
user_5 25/04 03:56 [success]
user_6 16/01 19:25 [failure]
user_6 15/11 20:08 [success]
user_7 08/02 23:13 [success]
user_2 03/06 15:31 [failure]
user_6 01/10 23:42 [success]
user_6 27/07 19:13 [success]
user_1 05/05 21:58 [success]
user_8 23/07 22:01 [success]
user_8 05/10 14:49 [success]
user_5 11/08 14:33 [success]
user_5 06/10 22:33 [success]
user_4 04/01 19:18 [success]
user_2 06/07 05:14 [success]
user_4 26/11 23:37 [success]
user_3 03/02 19:49 [success]
user_7 17/01 01:29 [success]
user_2 05/05 04:18 [success]
user_3 13/07 21:35 [success]
user_8 26/04 03:00 [success]
user_2 12/04 05:05 [success]
user_4 15/03 12:01 [success]
user_5 04/09 20:03 [success]
user_8 25/03 10:13 [success]
user_7 27/10 16:07 [success]
user_8 10/11 18:05 [success]
user_7 19/09 00:43 [success]
user_1 05/05 11:10 [success]
user_4 24/02 03:22 [success]
user_1 16/12 01:12 [success]
user_4 18/08 04:35 [success]
user_3 21/08 19:29 [success]
user_7 02/02 03:22 [success]
user_4 06/03 19:34 [success]
user_6 02/01 19:47 [success]
user_2 08/10 17:03 [failure]
user_2 03/05 11:13 [success]
user_1 13/03 05:47 [success]
user_3 17/11 22:47 [success]
user_2 04/09 11:27 [success]
user_5 15/12 13:28 [success]
user_5 23/07 23:37 [success]
user_2 16/09 08:16 [failure]
user_8 08/11 04:23 [failure]
user_3 02/07 18:02 [success]
user_6 15/10 05:15 [success]
user_3 25/04 18:52 [success]
user_8 14/02 18:49 [failure]
user_7 10/08 03:29 [failure]
user_5 26/07 00:05 [success]
user_3 13/07 05:29 [failure]
user_7 16/01 18:44 [success]
user_6 06/09 13:40 [success]
user_4 13/06 01:09 [success]
user_5 25/07 21:29 [success]
user_6 23/12 01:34 [success]
user_7 21/04 21:51 [success]
user_5 21/05 06:50 [success]
user_3 24/05 15:50 [success]
user_4 11/02 07:37 [success]
user_5 02/11 22:08 [failure]
user_7 01/08 13:14 [success]
user_6 01/01 12:29 [success]
user_5 15/09 08:34 [failure]
user_8 05/02 04:18 [success]
user_8 22/06 03:41 [success]
user_3 28/05 03:03 [success]
user_2 12/05 04:06 [success]
user_5 06/08 16:06 [success]
user_3 20/05 18:55 [success]
user_7 04/09 07:38 [success]
user_8 05/12 05:21 [success]
user_7 17/11 23:00 [success]
user_6 15/11 05:01 [success]
user_4 10/11 02:14 [success]
user_8 12/11 23:38 [success]
user_6 28/10 06:35 [success]
user_2 15/08 19:22 [success]
user_1 20/03 11:40 [success]
user_6 26/05 05:28 [success]
user_1 16/02 12:10 [success]
user_3 22/02 16:23 [success]
user_4 23/06 08:13 [failure]
user_4 16/10 18:46 [success]
user_1 11/07 08:16 [failure]
user_7 07/10 01:11 [failure]
user_4 26/03 13:37 [success]
user_4 20/05 00:21 [failure]
user_2 12/06 15:56 [success]
user_3 21/06 16:59 [failure]
user_5 10/03 15:48 [success]
user_5 11/10 02:40 [success]
user_1 07/01 09:43 [success]
user_6 07/12 14:50 [success]
user_6 26/04 06:15 [failure]
user_1 17/10 02:18 [success]
user_7 04/05 18:03 [success]
user_7 04/12 00:59 [success]
user_5 18/10 05:54 [success]
user_6 12/02 17:07 [success]
user_7 27/04 00:13 [success]
user_6 19/08 18:00 [success]
user_2 14/10 23:10 [success]
user_4 05/04 00:30 [success]
user_3 08/09 18:53 [success]
user_8 18/05 19:52 [success]
user_8 26/05 08:47 [success]
user_6 02/12 12:22 [success]
user_2 10/12 23:17 [failure]
user_7 24/12 11:28 [success]
user_6 26/04 06:21 [failure]
user_5 20/07 13:37 [success]
user_8 26/12 14:16 [success]
user_1 25/03 01:09 [success]
user_6 26/12 20:13 [success]
user_6 26/04 05:14 [success]
user_4 05/04 17:43 [success]
user_7 04/11 10:04 [success]
user_2 23/05 10:58 [success]
user_5 06/01 16:55 [success]
user_1 02/12 00:11 [success]
user_7 01/07 01:03 [success]
user_7 09/01 20:30 [success]
user_4 25/09 08:48 [success]
user_7 22/09 03:37 [success]
user_6 07/06 22:45 [success]
user_1 03/11 07:20 [success]
user_3 26/08 08:00 [success]
user_7 08/01 09:23 [success]
user_2 03/04 07:15 [success]
user_8 24/06 04:04 [success]
user_5 04/04 03:10 [success]
user_3 11/05 00:49 [failure]
user_5 14/02 23:26 [success]
user_5 16/04 00:39 [success]
user_3 05/08 12:03 [success]
user_7 13/10 17:53 [success]
user_6 21/10 23:22 [success]
user_7 18/11 03:23 [success]
user_8 04/01 17:05 [failure]
user_7 03/09 17:04 [success]
user_1 28/08 19:04 [success]
user_8 15/08 10:12 [success]
user_2 16/11 22:49 [success]
user_3 13/01 04:25 [success]
user_2 10/08 06:55 [failure]
user_1 14/09 20:22 [success]
user_8 26/06 13:59 [success]
user_7 16/07 11:05 [success]
user_2 01/02 15:08 [success]
user_2 02/02 21:38 [success]
user_7 27/01 19:46 [success]
user_5 13/08 18:16 [success]
user_4 02/07 07:38 [success]
user_2 15/10 11:01 [success]
user_5 10/10 01:41 [success]
user_1 02/10 23:09 [success]
user_6 26/03 10:51 [success]
user_4 05/03 10:58 [success]
user_4 21/03 02:49 [success]
user_6 04/11 05:58 [success]
user_2 02/01 22:23 [failure]
user_7 07/05 06:34 [success]
user_7 24/10 16:58 [success]
user_6 20/06 01:31 [failure]
user_2 07/05 10:03 [success]
user_4 13/05 22:28 [success]
user_5 21/07 18:38 [success]
user_1 11/08 13:28 [success]
user_5 07/03 22:42 [success]
user_3 17/02 10:39 [success]
user_7 27/11 11:02 [success]
user_1 19/07 20:46 [failure]
user_3 15/04 11:34 [success]
user_5 15/02 03:31 [success]
user_5 27/11 14:03 [success]
user_6 15/03 09:59 [success]
user_5 26/05 01:33 [success]
user_5 09/11 02:57 [failure]
user_2 23/06 19:05 [success]
user_4 26/04 15:02 [success]
user_2 26/03 10:21 [success]
user_2 06/06 00:29 [success]
user_4 22/08 05:30 [success]
user_7 08/06 23:34 [success]
user_5 14/02 19:37 [success]
user_7 02/08 19:52 [success]
user_6 28/08 00:26 [success]
user_5 16/04 15:49 [success]
user_2 28/05 17:35 [success]
user_3 12/07 12:13 [failure]
user_1 19/03 11:28 [success]
user_1 21/08 16:41 [success]
user_4 19/03 04:34 [success]
user_1 05/03 15:51 [failure]
user_1 13/08 11:30 [success]
user_7 03/02 11:14 [failure]
user_5 16/01 20:51 [failure]
user_4 25/12 17:49 [failure]
user_3 10/01 07:28 [success]
user_4 14/09 10:01 [success]
user_6 26/04 06:13 [failure]
user_8 12/03 13:51 [success]
user_3 21/05 21:39 [success]
user_3 12/02 20:54 [success]
user_4 19/03 01:57 [failure]
"""
class row_struct:
    def __init__(self, row) -> None:
        user, day, time, status = row.split(' ')
        self.user = user
        date_string = f"{day} {time}/{datetime.now().year}"
        self.timestamp = datetime.strptime(date_string, "%d/%m %H:%M/%Y").timestamp()
        self.failure = (status == '[failure]')

failure_users = {}
for row in text.splitlines():
    row_struct_sel = row_struct(row)
    if row_struct_sel.failure:
        failure_users.setdefault(row_struct_sel.user, []).append(row_struct_sel.timestamp)
M = 3 
WINDOW_SECONDS = 600
quantiles_users = set()
for user, timestamps in failure_users.items():
    if len(timestamps) < M:
        continue
    timestamps.sort()
    for i in range(len(timestamps) - M + 1):
        window_start_time = timestamps[i]
        window_end_time = timestamps[i + M - 1]
        if window_end_time - window_start_time < WINDOW_SECONDS:
            quantiles_users.add(user)
            break
print(" ".join(sorted(list(quantiles_users))))
